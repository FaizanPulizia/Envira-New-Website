---
import Logo from "@assets/logo_small.svg";

import { navLinks } from "./navlinks.ts";
---

<div
  id="navbar-container"
  class="group fixed inset-x-0 top-0 z-999 grid place-content-center px-4 pt-2 pb-2"
  data-is-hovered="false"
  onmouseenter='this.dataset.isHovered = "true"'
  onmouseleave='this.dataset.isHovered = "false"'
>
  <header
    id="navbar"
    data-visibility="hidden"
    class="pointer-events-none relative rounded-full border border-green-600 bg-gradient-to-br from-green-500 to-teal-500 py-2 pr-8 pl-4 shadow-2xl shadow-green-800 transition-transform duration-500 ease-out group-hover:[transform:translateY(0%)]"
    style="--translateY:-250%; "
  >
    <div
      class="pointer-events-auto flex size-full items-center justify-between gap-6 text-white md:gap-16"
    >
      <a href="/">
        <Logo class="size-10 md:size-12" />
      </a>
      <nav class="flex items-center justify-center gap-2 md:gap-4">
        {
          navLinks.map((navLink) => (
            <a
              class="relative rounded-full bg-white/5 text-xl transition-transform duration-500 before:absolute before:inset-x-0 before:bottom-0 before:mt-1 before:h-px before:origin-left before:scale-x-0 before:bg-slate-200 before:transition-transform before:duration-500 before:ease-in hover:-translate-y-1 hover:before:scale-x-100 hover:before:ease-out"
              href={navLink.href}
            >
              {navLink.name}
            </a>
          ))
        }
      </nav>
    </div>
  </header>
</div>

<script>
  const navbarContainer = document.getElementById("navbar-container")!;
  const navbar = document.getElementById("navbar")!;

  let lastScrollY = window.scrollY;

  window.addEventListener("scroll", () => {
    const currentScrollY = window.scrollY;
    const isHovered =
      navbarContainer.dataset.isHovered?.toLowerCase().trim() === "true";
    const isNavbarHidden =
      navbar.dataset.visibility?.trim().toLowerCase() === "hidden";

    // Don't animate if hovered or already animating
    if (isHovered) {
      lastScrollY = currentScrollY;
      return;
    }

    // Only trigger animation if scroll distance is significant (prevents jitter)
    if (Math.abs(currentScrollY - lastScrollY) < 100) {
      return;
    }

    if (currentScrollY < lastScrollY) {
      // Scrolling up - show navbar
      if (isNavbarHidden) {
        showNavbar();
      }
    } else {
      // Scrolling down - hide navbar
      if (!isNavbarHidden) {
        hideNavbar();
      }
    }

    lastScrollY = currentScrollY;
  });

  function showNavbar() {
    navbar.dataset.visibility = "visible";
    navbar.style.transform = "translateY(0)";
    setTimeout(() => {
      hideNavbar();
    }, 1000);
  }
  function hideNavbar() {
    navbar.dataset.visibility = "hidden";
    navbar.style.removeProperty("transform");
  }
</script>
