<div
  id="hero-video-container"
  class="pointer-events-none absolute inset-0 -z-20 overflow-hidden rounded-lg"
>
  <div
    class="relative isolate size-full before:absolute before:inset-0 before:z-10 before:bg-black/20 before:content-['']"
  >
    <video
      class="h-full w-full object-cover"
      src="https://assets.mixkit.co/videos/46502/46502-720.mp4"
      autoplay
      muted
      loop
      playsinline></video>
  </div>
</div>

<script>
  import getClipPath, { type ScreenSpaceCoordinate } from "@utils/getClipPath";

  const videoContainer = document.getElementById("hero-video-container")!;

  const clipPathCornerNodes: ScreenSpaceCoordinate[] = [
    [0, 1, 0], // Outer
    [0, 0.1, 0], // Outer
    [0.3, 0.1, 1], // Inner
    [0.35, 0, 1], // Inner
    [1, 0, 0], // Outer
    [1, 0.9, 0], // Outer
    [0.7, 0.9, 1], // Inner
    [0.65, 1, 1], // Inner
  ];

  function drawVideoContainerClip() {
    const width = videoContainer.offsetWidth;
    const height = videoContainer.offsetHeight;
    const path = getClipPath({
      containerWidth: width,
      containerHeight: height,
      coordinates: clipPathCornerNodes,
      arcRadius: 20,
    });
    videoContainer.style.clipPath = `path('${path}')`;
  }

  drawVideoContainerClip();

  let timeout: any;
  window.addEventListener("resize", () => {
    clearTimeout(timeout);
    timeout = setTimeout(() => {
      drawVideoContainerClip();
    }, 100);
  });
</script>
