---
import Logo from "@assets/logo_small.svg";
import { navLinks } from "@constants/navLinks";
---

<div
  id="navbar-container"
  class="group fixed inset-x-0 top-0 z-999 grid place-content-center p-4"
  data-is-hovered="false"
  onmouseenter='this.dataset.isHovered = "true"'
  onmouseleave='this.dataset.isHovered = "false"'
>
  <header
    id="navbar"
    data-visibility="hidden"
    class="relative rounded-full border border-green-600 bg-gradient-to-br from-green-500 to-teal-500 py-2 pr-8 pl-4 shadow-2xl shadow-green-800 transition-transform duration-500 ease-out group-hover:[transform:translateY(0%)]"
    style="--translateY:-250%; "
  >
    <div class="flex size-full items-center justify-between gap-6 md:gap-16">
      <a href="/">
        <Logo class="size-10 text-white md:size-12" />
      </a>
      <nav
        class="flex items-center justify-center gap-2 will-change-contents md:gap-5"
      >
        {
          navLinks.map((navLink) => (
            <a
              class="text-base font-light transition-all hover:font-normal hover:text-shadow-md md:text-xl"
              href={navLink.href}
            >
              {navLink.name}
            </a>
          ))
        }
      </nav>
    </div>
  </header>
</div>

<script>
  const navbarContainer = document.getElementById("navbar-container")!;
  const navbar = document.getElementById("navbar")!;

  navbar.classList.add("[transform:translateY(var(--translateY))]");

  let lastScrollY = window.scrollY;

  window.addEventListener("scroll", () => {
    const currentScrollY = window.scrollY;
    const isHovered =
      navbarContainer.dataset.isHovered?.toLowerCase().trim() === "true";
    const isNavbarHidden =
      navbar.dataset.visibility?.trim().toLowerCase() === "hidden";

    // Don't animate if hovered or already animating
    if (isHovered) {
      lastScrollY = currentScrollY;
      return;
    }

    // Only trigger animation if scroll distance is significant (prevents jitter)
    if (Math.abs(currentScrollY - lastScrollY) < 100) {
      return;
    }

    if (currentScrollY < lastScrollY) {
      // Scrolling up - show navbar
      if (isNavbarHidden) {
        navbar.dataset.visibility = "visible";
        navbar.style.transform = "translateY(0)";
      }
    } else {
      // Scrolling down - hide navbar
      if (!isNavbarHidden) {
        navbar.dataset.visibility = "hidden";
        navbar.style.removeProperty("transform");
      }
    }

    lastScrollY = currentScrollY;
  });
</script>
